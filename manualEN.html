<!DOCTYPE html>
<html lang="en-EN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServerBot Manual</title>
    <link rel="icon" type="image/x-icon" href="Files/favicon.ico">
    <meta name="description" content="ServerBot v1.10.0 User Manual [EN]">
    <meta name="author" content="Kamile320">

    <style>
        body {
            background-image: linear-gradient(to right, rgb(141, 205, 226), rgb(62, 62, 255), rgb(3, 165, 3));
            font-family: Arial;
        } 

        h1 {
            margin: 0;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
        }

        .card {
            background-color: rgb(241, 220, 174);
            margin: 50px auto;
            width: 80%;
            height: auto;
            padding: 20px;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
            transition: 0.3s;
        }

        .card:hover {
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="card">
        <font size="6">
            <center><h1><i>ServerBot User Manual v1.10.0</i></h1></center>
        </font>
        <hr style="height: 5px; background: rgb(5, 5, 99); border: 2px;">

        <iframe align="right" src="https://discord.com/widget?id=1243950731954749450&theme=dark" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>

        <a href="https://github.com/kamile320/ServerBot">ServerBot</a> - Discord Bot developed by <b><u>Kamile320</u></b> that features:<br>
        <ul>
            <li>Server Administration</li>
            <li>Playing music from local files and YouTube URL's</li>
            <li>Host Computer Management</li>
            <li>Executing bash scripts</li>
            <li>Message logging</li>
            <li>Creating threads</li>
            <li>File and Directory Management</li>
            <li>SQLite3 database support</li>
            <li>AI command (using Gemini API)</li>
            <li>And more</li>
        </ul>
        
        <br>

        <h3>Content:</h3>
        <ol>
            <li><a href="#dirs">Structure of Directory</a></li>
            <li><a href="#start">First Run</a></li>
            <li><a href="#autostart">Autostartup</a></li>
            <li><a href="#token">Tokens</a></li>
            <li><a href="#admin">UserID and bot Administrators</a></li>
            <li><a href="#ffmpeg">Windows - FFmpeg installation</a></li>
            <li><a href="#modules">Bot Modules/Extensions</a></li>
            <li><a href="#ai">.ai command</a></li>
            <li><a href="#db">Database (SQLite3)</a></li>
            <li><a href="#comma">Commands</a></li>
        </ol>

        <br>

        <h3 id="dirs">List of Files and Directories:</h3>

        <ol>
            <li><b>ServerBot.py</b> - Main script file</li>
            <li><b>setup.bat</b> - File that installs required python libraries (Windows)</li>
            <li><b>setup.sh</b> - Operation menu: starting the bot, installing required libraries, etc. (requires installation of the "dialog" command)</li>
            <li><b>Logs.txt</b> - File with the bot event log on the server</li>
            <li><b>manualPL.html</b> - Bot Manual [PL]</li>
            <li><b>manualEN.html</b> - Bot Manual [EN]</li>
            <li><b>Media</b> - Directory with Music/Sound files</li>
            <li><b>ACL</b> - User message log (after enabling <a href="#ACL">ACL</a>)</li>
            <li><b>.env</b> - Special file for Bot Tokens</li>
            <li><b>.venv</b> - Python Virtual Environment (After using setup.sh - option 4)</li>
            <li><b>tempDB.txt</b> - Temporary file with database content (after using .showdb command)</li>
            <li>
                <b>Files</b> - Directory with required (and not) Bot files
                <ul>
                    <li><b>favicon.ico</b> - Manual icon</li>
                    <li><b>updates.txt</b> - List of recent updates</li>
                    <li><b>Logs.txt</b> - Copy of Bot Logs</li>
                    <li><b>autorun.sh</b> - After using <a href="#autostart">.mkservice</a></li>
                    <li><b>serverbot.db</b> - SQLite3 Database</li>
                    <li><b>systemd_add.py</b> - Systemd service creation script</li>
                    <li>Other Files (photos, videos, etc.)</li>
                    <li><b>setup</b> - Config Files</li>
                    <ul>
                        <li><b>setuplib.sh</b> - Installer of pip3 Libraries</li>
                        <li><b>mkvenv.sh</b> - Creates <a href="#autostart">venv</a></li>
                        <li><b>requirements.txt</b> - List of required python libraries</li>
                    </ul>
                </ul>
            </li>
        </ol>
        
        <br>

        <p align="right">Pic. 1 - Running the script</p>
        <a href="Files/UbuntuSB.png"><img align="right" src="Files/UbuntuSB.png" width="40%" height="40%"></a>
        
        
        <h3 id="start">First run:</h3>
        <h5>The Bot requires:</h5>
        <ul type="square">
            <li>Python 3.9 or later</li>
            <li>Internet connection</li>
            <li>Required python libraries installed (see setup.sh/setuplib.sh/requirements.txt contents)</li>
            <li>Adding FFmpeg files to the PATH environment - Windows only (see YT)</li>
            <li>Operating System: Linux (recommended) / Windows / MacOS - 64 bit (Recommended)</li>
            <li>setup.sh - requires the "dialog" command</li>
        </ul>

        <br>
        
        You should run the script (python3 or setup.sh) through the IDE, terminal or other program.<br>
        If something goes wrong, the Bot should let you know what the problem is<br>
        and ask for approval of the correction or it will abandon the launch/installation.<br>
        After running the script, Bot should connect with Discord and be ready to work.<br>
        [!] You can install bot via .deb file - remember that bot will install in /usr/share/serverbot. 
        Use serverbot command with sudo, if you want configure <a href="#autostart">autostart</a>.<br>
        <br>

        The current Bot Commands can be seen using the .help command

        <br>

        <h3 id="autostart">Autostart using systemd:</h3>

        When using the Bot, you may want it to start automatically with the operating system (Linux).<br>
        To easily enable this, there is the .mkservice command.<br>
        After entering the command, you must provide an additional value:<br><br>
        
        <b>def</b> -> creates default autorun.sh file in the <a href="#dirs">Files</a> directory. Works on systems based on Ubuntu <b>22.04</b> (doesn't use venv)<br><br>

        <b>venv</b> -> sometimes when installing modules using pip3 an <i>externally managed pip</i> error may appear .<br>
        In this case, you should create a Python Virtual Environment/Venv.<br>
        If you have not created it yet, it is recommended to create it in the main Bot directory (ServerBot).<br><br>
        Example: .mkservice venv -> executing command on Discord; script of the Bot runs in main directory.<br>
        NOTE! The bot (or rather setup.sh) is adapted to the name of a directory with a virtual environment called ".venv".<br>
        If you manually created venv with different directory name, the bot may not start!<br>
        It is recommended to use proper options from setup.sh -> It will easily install and configure everything needed.<br>
        For the autostart to work, you need to set the Bot files with read/write/execute permissions to 775 (r-x for everyone, rwx for owner and group) if those files don't already have them.
        I recommend moving the Bot files to the /ServerBot directory (so that it is not in other directories). Do not install bot in your home directory if you want to run it with system startup.<br><br>

        <b><i>How to create venv:</i></b><br>
        <ol>
            <li>in the main bot directory, type: <b>python3 -m venv .venv</b></li>
            <li>to activate venv: <b>source .venv/bin/activate</b> (as root)</li>
            <li>check version and location: <b>which python</b></li>
            <li>once you are in venv, run <b>setup.sh</b></li>
            <li>(optional) to exit venv, type: <b>deactivate</b></li>
            <li>or simpler - just use option 4 in <b>setup.sh</b> to run automatic install and enter to venv</li>
        </ol>

        <p>Full documentation of venv <a href="https://packaging.python.org/en/latest/guides/installing-using-pip-and-virtual-environments/">here</a>.</p>

        <p align="right">Pic. 2 - setup.sh options</p>
        <a href="Files/setupSB.png"><img align="right" src="Files/setupSB.png" width="35%" height="35%"></a>
        

        <h3 id="token">Tokens</h3>
        The Bot uses API tokens of: Discord, Gemini and user IDs.<br>
        In order for the bot to run, you need to fill in the <b>.env</b> file with the appropriate data.<br><br>
        <b>Scheme:</b><br>
        TOKEN="bot token"<br>
        AI_token="gamini token (to use .ai)"<br>
        admin_usr = ['your discord user ID']<br>
        dscserv_link = 'Link to your Discord Server'<br>
        addstable = 'stable_link of Discord Bot'<br>
        addtesting = 'testing_link of Discord Bot'<br>
        service_monitor = 'True/False' -> enables .service command<br>
        service_list = 'List of systemd services to see via Discord'<br>
        showmodulemessages = 'True/False' -> shows which Bot modules are enabled<br>
        ACLmodule = 'True/False' -> Enables <a href="#ACL">AdvancedChannelListener</a> module<br>
        aimodel = 'gemini-2.5-flash' -> selected gemini's language model<br>
        instructions = ['Instructions for language model']<br>
        extendedErrMess = 'True/False' -> turns on/off extended error messages<br><br>
        
        <h4 id="#admin">User ID and bot Administrators</h4>
        Some commands uses Operating System data and functions,<br>
        so it requires administrator privileges to run - you don't want to have system removed by unauthorized user, right?<br>
        To execute them, you must provide the ID of trusted and authorized users that can execute these commands in <b>admin_usr</b>. You should be the only one who has rights to execute them.<br>
        Some commands are intended for Discord Server Moderators - they allow you to interfere with the Discord Server. You can grant Mod privileges to Mod Users in the database using <b>.db op {userID}</b> command. If you want to revoke Mod privileges - use <b>.db deop {userID}</b>.<br>
        They should be trusted moderators of your discord server. If none of the users have Mod privileges in database, only Bot Administrators will be able to use Mod commands.<br>
        
        <br>

        <h3 id="ffmpeg">Windows - FFmpeg installation</h3>
        <a href="https://www.ffmpeg.org/download.html">FFmpeg</a> is responsible for playing music on Voice Channels. On Windows FFmpeg installation looks different than on Linux.<br>
        You have to manually install and add FFmpeg files to local user PATH:<br>
        <ol>
            <li>Download .zip of FFmpeg program from <a href="https://github.com/BtbN/FFmpeg-Builds">GitHub</a> repository, preferably from the <a href="https://github.com/BtbN/FFmpeg-Builds/releases/download/latest/ffmpeg-master-latest-win64-gpl-shared.zip">link</a> provided in the script.</li>
            <li>Extract files to C:\ffmpeg directory (.exe files must be located in C:\ffmpeg\bin directory).</li>
            <li>Open Start Menu and search for 'Environment Variables' - select 'Edit the system environment variables'</li>
            <li>Select 'Path' variable in 'User variables' and click 'Edit'</li>
            <li>Click 'New' and add 'C:\ffmpeg\bin' (without quotes)</li>
            <li>Click OK to close all windows</li>
            <li>Restart your computer to apply changes</li>
        </ol>
        After these steps, FFmpeg should be installed and ready to use with the Bot.<br>

        <br>

        <h3 id="modules">Bot Extensions/modules</h3>

        Bot has extensions/modules that extend functions, which can be enabled or disabled in the .env file.<br>
        Modules are also available as separate repositories (Discord Bots) on GitHub.<br>
        <ul type="square">
            <li>
                <a id="ACL" href="https://github.com/kamile320/AdvancedChannelListener"><b>AdvancedChannelListener</b></a> - shows user messages sent on Discord, saves them in ACL/[DiscordUserID].txt file and all messages in ACL/default/message.txt<br>
                Useful for monitoring users on the server and verifying who is who. It can break user privacy, so use it wisely.<br>
                If you don't want to use this - set ACLmodule = 'False' in .env (set as default).
            </li>
            <li>
                <b>.service</b> - command that allows to check status of systemctl services running on your host server. Enable service_monitor and provide a list of services in service_list in .env file. 
            </li>
        </ul>

        <br>

        <h3 id="ai">.ai command</h3>
        The .ai command allows you to talk with artificial intelligence. Uses Google's Gemini API.<br>
        Get a gemini token (On the <a href="https://ai.google.dev/">Google AI dev</a> page) and put token in .env file in the 'AI_token' field.<br>
        In .env file you cen set language model (gemini-2.5-flash as default) in the 'aimodel' field, and instructions for a model in a 'instructions' field.<br>
        I recommend leaving default instruction that limits response to 1500 characters - longer response may not be send to discord channel and cause an error.<br>


        <br>

        <h3 id="db">Database (SQLite3)</h3>
        Bot uses SQLite3 database to store informations about users like:<br>
        <ul type="square">
            <li>User ID</li>
            <li>User Status (Moderator etc.)</li>
            <li>Other data related to users (in the future)</li>
        </ul>
        Database file is located in '<a href="#dirs">Files</a>/serverbot.db'. Bot automatically creates database and collects data after every message sent on channel.<br>
        It's required to working functions correctly that uses database, such as moderator commands.<br>
        In the future it's planned to add more functions that use database, not necessarily using user ID's.<br>
        The following commands allow managing the database from Discord:<br>
        <ul type="square">
            <li><b>.db register {userID} {username}</b> - manually registers user in DB</li>
            <li><b>.db remove {userID}</b> - removes user from DB</li>
            <li><b>.db op {userID}</b> - grants bot moderator status to the user</li>
            <li><b>.db deop {userID}</b> - revokes bot moderator status to the user</li>
            <li><b>.db select {userID}</b> - shows saved data of user</li>
            <li><b>.db setnickname {nickname} {userID}</b> - sets users nickname in DB; if no ID is provided, sets nickname for the user who invoked the command</li>
            <li><b>.showdb</b> - saves database content to tempDB.txt file and sends it as a response</li>
        </ul>

        <br>

        <h3 id="comma">Basic Commands:</h3>
        <table border>
            <tr valign="top" align="center">
                <td>
                    ======Chat======<br>
                    hello<br>
                    bye<br>
                    hi<br>
                    hello_there<br>
                </td>

                <td>
                    =========Converter=========<br>
                    binary {dec. number}<br>
                    hexa {dec. number}<br>
                    convert {type} {number}<br>
                </td>

                <td>
                    ========Fun========<br>
                    random<br>
                    banner<br>
                    botbanner<br>
                    blankthing<br>
                    apple<br>
                    ai<br>
                    badge<br>
                </td>

                <td>
                    ======Admin======<br>
                    ShutDown<br>
                    copylog<br>
                    bash<br>
                    rebuild<br>
                    mkshortcut<br>
                    mkservice {mode}<br>
                    service<br>
                    pingip<br>
                    module<br>
                    db<br>
                    showdb<br>
                </td>
            </tr>
            <tr valign="top" align="center">
                <td>
                    =====BotInfo=====<br>
                    manual {web/local}<br>
                    credits<br>
                    time<br>
                    ping<br>
                    release<br>
                    next_update<br>
                </td>

                <td>
                    ========FileManager========<br>
                    cd {directory}<br>
                    dir {mode}<br>
                    file {mode} {filename}<br>
                    touch {file} {content}<br>
                </td>

                <td>
                    ====VoiceChannel====<br>
                    join<br>
                    leave<br>
                    play {file dir}<br>
                    ytplay {type} {link}<br>
                    ytsearch<br>
                    stop<br>
                    pause<br>
                    resume<br>
                    waiting<br>
                </td>

                <td>
                    =====ModOnly=====<br>
                    testbot<br>
                    testos<br>
                    disks<br>
                    delete<br>
                    cleaner<br>
                    webreq<br>
                    kick<br>
                    ban<br>
                    unban<br>
                    invitegen<br>
                    echo<br>
                </td>
            </tr>
        </table>
    </div>
</body>
</html>